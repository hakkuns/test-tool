# Testing Assistant Suite 使い方

## 概要

PostgreSQL データベースと API のテストを効率化するツールです。テストシナリオでテーブル定義、テストデータ、モック API を統合管理できます。

## 主な機能

- **シナリオ管理**: テーブル定義(DDL)、テストデータ、モックAPI、テスト設定を一括管理
- **グループ管理**: シナリオをグループ化して整理、インポート/エクスポート可能
- **お気に入り**: よく使うシナリオを⭐で登録
- **タグ検索**: シナリオにタグを付けて検索
- **定数機能**: `$TIMESTAMP`, `$UUID`, `$RANDOM_INT` などの定数を使用可能

## 基本的な使い方

### 1. シナリオの作成

1. 「新規作成」ボタンをクリック
2. 基本情報を入力（シナリオ名、説明、グループ、タグ）
3. 対象API設定（HTTP メソッド、URL）
4. テスト設定（Headers、Body）※定数使用可能
5. テーブル定義を追加（DDL、依存関係）
6. テストデータを追加
7. モックAPIを追加（必要に応じて）
8. 保存

### 2. シナリオの実行

1. **API Test** ページを開く
2. グループフィルターでグループを選択（オプション）
3. シナリオを選択して「適用」ボタンをクリック
   - テーブル作成、データ投入、モックAPI設定が自動実行
4. リクエストフォームにテスト設定が自動入力される
5. 必要に応じて編集
6. 「Send Request」でテスト実行

### 3. モックAPIの使用

モックAPIのエンドポイント形式:
```
http://localhost:3001/api/mock/serve/{パス}
```

**devContainer から接続する場合:**
```
http://host.docker.internal:3001/api/mock/serve/{パス}
```

### 4. 定数機能

テスト設定やモックAPIレスポンスで使用可能:

- `$TIMESTAMP`: 現在時刻のタイムスタンプ（ミリ秒）
- `$UUID`: ランダムなUUID
- `$RANDOM_INT`: ランダムな整数（0〜9999）
- `$DATE`: 現在日付（YYYY-MM-DD）
- `$TIME`: 現在時刻（HH:mm:ss）

例:
```json
{
  "id": "$UUID",
  "createdAt": "$TIMESTAMP"
}
```

「定数を再変換」ボタンで新しい値に更新できます。

## インポート・エクスポート

- **シナリオ**: 個別エクスポート、全シナリオエクスポート、インポート
- **グループ**: グループ単位でエクスポート/インポート（含まれるシナリオも一括）

## その他の機能

### シナリオ管理

- **グループ移動**: シナリオカードメニューから移動先を選択
- **お気に入り**: ⭐アイコンをクリックで登録/解除
- **コピー**: シナリオカードメニューから複製
- **削除**: シナリオカードメニューから削除

### 検索とフィルター

- **テキスト検索**: シナリオ名や説明で検索
- **グループフィルター**: グループごとに表示（シナリオが属しているグループのみ表示）
  - グループ変更時、そのグループ内の最新シナリオが自動選択

### その他

- **curlコピー**: リクエストフォームからcurlコマンドをコピー
- **リクエスト履歴**: 最大50件まで自動保存、再実行可能
- **再適用**: シナリオ編集後は「再適用が必要」バッジが表示され、再適用が必要

## Tips

- グループ機能で大量のシナリオを整理
- タグで検索・フィルタリング
- 頻繁に使うシナリオは⭐お気に入りに登録
- シナリオにデフォルト設定を保存して入力の手間を削減
- 似たシナリオはコピーして編集すると効率的
- GET/DELETE/HEAD/OPTIONS メソッドではボディ送信不可

## トラブルシューティング

### データベースに接続できない
- ナビゲーションバーのDB接続アイコンをクリックして設定確認
- PostgreSQL サーバーが起動しているか確認

### テーブルが作成できない
- DDL構文を確認
- 依存関係の順序を確認（外部キーは参照先テーブルの後に作成）

### モックAPIが動作しない
- パスとHTTPメソッドを確認
- API Test ページの「Mock Logs」でログを確認
- devContainer から接続する場合は `host.docker.internal` を使用
